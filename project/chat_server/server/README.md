# Server 구현 기능 목록

## 실행 환경

* server.py 는 c++ script 로 되어있습니다. <br>

## 기능

### 닉네임 변경하기 (/name {nickname})
1. [X] 처음 연결되면 (127.0.0.1, 9130) 처럼 클라이언트 측 IP주소와 포트 번호를 이름으로 부여하기
2. [X] 해당 클라이언트에게 이름 변경 시스템 메세지 전송
3. [ ] 만약 대화방인 경우, 대화방 모든 멤버에게 이름 변경 시스템 메세지 전송

### 현재 대화방 목록 출력하기 (/rooms)
1. [X] 대화방 목록 방 번호, 방 제목, 참여중인 멤버 이름 순으로 나열하기
2. [X] 개설된 대화방이 없는 경우, 자유롭게 표시하기 

### 대화방 개설하기 (/create {roomName})
1. [ ] 해당 유저가 참여 중인 대화 방이 없는 경우, 유저는 대화방 개설 가능
2. [ ] 만약 다른 방에 들어가 있는 경우, 해당 유저에게 대화방 개설 불가 시스템 메세지 전송하기
3. [X] 대화방 개설과 동시에 해당 유저는 해당 대화방 자동 입장

### 이미 개설된 방 참여하기 (/join {roomNum})
1. [X] 해당 유저가 참여 중인 대화 방이 없는 경우, 유저는 대화방 참여 가능
2. [X] 만약 다른 방에 들어가 있는 경우, 해당 유저에게 대화방 입장 불가 시스템 메세지 전송하기
3. [X] 만약 없는 방 번호인 경우, 해당 유저에게 대화방 미등록 시스템 메세지 전송하기
4. [X] 만약 해당 대화 방에 참여하면, 해당 유저에게 대화방 입장 시스템 메세지 전송하기 
5. [X] 만약 해당 유저가 대화 방에 입장하면, 해당 대화 방에 입장 시스템 메세지 broadcasting 하기

### 대화방 나가기 (/leave)
1. [ ] 만약 대화방 참여 중이지 않을 때, 해당 유저에게 대화방 미참여 시스템 메세지 전송하기
2. [ ] 만약 해당 유저가 대화방을 나갔다면, 해당 대화 방에 퇴장 시스템 메세지 broadcasting 하기
3. [ ] 만약 해당 유저가 대화방을 나갔다면, 해당 유저에게 대화 방 퇴장 시스템 메세지 전송하기

### 채팅 서버 종료하기 (/shutdown)
1. [ ] 생성한 쓰레드들을 정리하고 프로그램 종료하기

### 그 외 기능
1. [ ] `/`로 시작하지 않는 문자열은 채팅 메세지로 인식하기
2. [ ] 만약 대화 방에 없는 경우, 해당 유저에게 대화방 미참여 시스템 메세지 전송하기
3. [ ] 만약 대화 방에 있는 경우, 해당 대화 방에 해당 메세지 broadcasting 하기

## 구현 요구 조건
* [X] worker thread 2개 이상으로 지정할 수 있도록 하기
* [ ] worker thread 2개 이상일 때 위 명령어 제대로 동작하는지 (= synchronization 구현 여부)
* [ ] 둘 이상의 채팅 방 유저들이 나눠 들어가 있는 경우 대화방 간 간섭 없이 제대로 채팅 되도록 하기
* [X] I/O multiplexing 적용 여부
* [X] producer-consumer 적용 여부
* [X] Message Handler Map 적용 여부 
* [X] JSON 구현 
* [ ] Protobuf 구현

## 리팩토링
* [ ] 연속된 메세지를 race condition이 발생하지 않도록 처리하기

## 문제
* [ ] 클라이언트들 중 하나가 강제 종료했을 때 나머지 클라이언트들이 서버 요청을 못하는 문제 발생